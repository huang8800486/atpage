<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>交易系统</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="format-detection" content="telephone=no">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <meta name="keyword" content="比特币价格,比特币交易平台,区块链,数字化资产,比特币行情,AT交易所,USDT,莱特币,BCH,以太坊,ETH,以太经典,进行币币交易" />
    <meta name="description" content="description:AT交易所是一家集数字化资产、投资服务、资讯服务于一体的国际化区块链资产交易平台。提供比特币,莱特币(LTC),以太坊(ETH),比特币现金(BCH),以太经典(ETC)达世币(DASH)等虚拟货币以比特币(BTC)、USDT进行交易！提供实时比特币价格,比特币行情。">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="stylesheet" href="././assets/css/reset.css">
    <link rel="stylesheet" href="././assets/font/iconfont.css">
    <link rel="stylesheet" href="././assets/css/layout.css">
    <script src="./script/jquery-3.3.1.min.js"></script>
    <script src="./script/tools/crypto-js.js"></script>
    <script src="./script/tools/jquery.cookie.js"></script>
    <script src="./script/tools/md5.min.js"></script>
    <script src="./script/tools/k_tools.js"></script>
    <script src="./script/tools/loadSiteInfo.js"></script>
    <script src="./script/template.js"></script>
    <script src="./script/layer.js"></script>
    <script type="text/javascript" charset="utf-8" src="//g.alicdn.com/sd/ncpc/nc.js?t=2015052012"></script>
    <script type="text/javascript" charset="utf-8" src="//g.alicdn.com/sd/nch5/index.js?t=2015052012"></script>
    <script src="./script/common/common.js"></script>
    <script src="./assets/js/translate/jquery.i18n.properties/jquery.i18n.properties.min.js" charset="utf-8"></script>
    <script src="./assets/js/translate/i18n.config.js" charset="utf-8"></script>
</head>
<body>
    <div class="view_body security_center_view_body forget_login_pwd_view_body">
        <!-- header -->
        <header id="header" class="header header-other"></header>
        <div class="negative_content_page">
            <div class="dynamic-width negative_content">
                <div class="modify_personal_info">
                    <div class="safety-form">
                        <h2 class="per_titl" class="forgetLoginPwd" translate="zhaohuidenglumima">找回登录密码</h2>
                        <!--忘记密码第一步-->
                        <div class="forgetLoginPwd" id="find_step1">
                            <div class="reg-list forget">
                                <div class="am-form-group_wrap">
                                    <div class="am-form-group">
                                        <span class="titl" translate="security_first11">用户名</span>
                                        <div class="input_wrap">
                                            <input id="phone" type="text" class="frominput" value="" placeholder="">
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <span class="titl" translate="financial_first48">验证码</span>
                                        <div class="input_wrap">
                                            <input id="moble_verify" type="text" class="frominput" value="" placeholder="">
                                            <button id="btn_sendCode" onclick="getCode(this)" type="button" class="secodes" translate="financial_first49">获取验证码</button>
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <span class="titl" translate="new_password">新密码</span>
                                        <div class="input_wrap">
                                            <input id="loginPwd" type="password" class="frominput" value="" placeholder="" maxlength="20" autocomplete="new-password" onkeyup="chckeStrength(this, this.value)">
                                            <strong class="pwd_tips"></strong>
                                            <p class="pwdstrength" translate="6_20">6～20位，必须包含大小写字母和数字</p>
                                        </div>
                                    </div>
                                    <div class="am-form-group">
                                        <span class="titl" translate="security_first33">确认密码</span>
                                        <div class="input_wrap">
                                            <input id="loginRePwd" type="password" class="frominput" value="" placeholder="" maxlength="20" autocomplete="new-password">
                                            <p class="pwdstrength" translate="6_20">6～20位，必须包含大小写字母和数字</p>
                                        </div>
                                    </div>
                                    <a id="btn_next" onclick="next()" type="button" class="new-btn-color" translate="security_button">确认修改</a>

                                    <div class="notes">
                                        <span translate="reminder1"></span>
                                        <p translate="security_info2"></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--忘记密码第三步-->
                        <div class="forgetLoginPwd" id="find_step2" style="display: none">
                            <div class="reg-info-tip am-text-center">
                                <p><img src="./images/icon-yes.png" ></p>
                                <h1 translate="gongxi_mima">恭喜您密码修改成功!</h1>
                                <p class="deep-gray"><span id="wait">3</span> <em class="translate_em" translate="seconds_will"></em></p>
                                <p style="width:100%;position:relative;"><a href="javascript:void(0)"  style="position:static" onclick="window.location.href='login.html'" class="am-btn am-radius am-btn-lg new-btn-color" translate="go_to_login">去登录账号</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        <footer id="footer" class="footer"></footer>
        <div class="am-modal am-modal-no-btn" tabindex="-1" id="modelBox">
            <div class="am-modal-dialog">
                <div class="am-modal-hd" translate="verification">验证
                    <a id="at_modlog" href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close>&times;</a>
                </div>
                <dl class="am-modal-bd" id="sliderBox" style="padding: 10px 20px;">
                 <div id="aliSliderBox" class="nc-container"></div> 
                </dl>
                <button id="btn_slider" onclick="SendCode()" type="button" class="am-btn am-btn-secondary am-radius" style="float: right;margin-right: 20px" translate="make_sure">确定</button>
            </div>
        </div>
    </div>
<!--[if lt IE 9]>
<script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>
<script src="./assets/js/amazeui.ie8polyfill.min.js"></script>
<![endif]-->

<script src="./assets/js/amazeui.min.js"></script>
<script src="./assets/js/count-number.js"></script>

<script type="text/javascript">
    jQuery(document).ready(function () {
        $(".btn-close").click(function () {
            $(".top-ad").hide();
        });
    });
</script>

<script type="text/javascript">
    $(function () {
        $("#header").load("./main/common/indexHeader.html?version=" + $.version);
        $("#footer").load("./main/common/indexFooter.html?version=" + $.version);
        $("#phone").attr("placeholder",langPkg.getI18N("qingshuruyonghuming"));
        $("#moble_verify").attr("placeholder",langPkg.getI18N("mobile_verify_placeholder"));
		$("#loginPwd").attr("placeholder",langPkg.getI18N("security_first32_placeholder"));
		$("#loginRePwd").attr("placeholder",langPkg.getI18N("confirm_code_placeholder"));
    });
</script>

<!--初始化步骤-->
<script type="text/javascript">
    function chckeStrength(obj, objvalue){
        if($.passwordStrength(objvalue)){
            $(obj).parents(".am-form-group").find(".pwd_tips").html("")
            $(obj).removeClass("v_error_new")
        }else{
            $(obj).addClass("v_error_new")
            $(obj).parents(".am-form-group").find(".pwd_tips").html(langPkg.getI18N("mimaqiangdutaidi"))
        }
    }

    function getUserInfo() {
        $.ajaxSendData("", "/api/user/details", function(resData){
            $("#trueName").html(resData.data.nickname)
        });
    }
    //  第一步
    function next() {
        if($("#btn_next").attr("disabled") == "disabled"){
            return false;
        }
        var username = $("#phone").val();
        var code = $("#moble_verify").val();
        var loginPwd = $("#loginPwd").val();
        var loginRePwd = $("#loginRePwd").val();

        if (code == "") {
            layer.tips(langPkg.getI18N("mobile_verify_placeholder"), "#moble_verify", {
                tips: [3, "#0e9e80"], time: 2000, end: function () {
                    $("#btn_next").removeAttr("disabled");
                }
            });
            return false;
        }

        if (loginPwd == "") {
            layer.tips(langPkg.getI18N("phone_password_null_error"), "#loginPwd", {
                tips: [3, "#0e9e80"], time: 2000, end: function () {
                    $("#btn_next").removeAttr("disabled");
                }
            });
            return false;
        }
        if (loginRePwd == "") {
            layer.tips(langPkg.getI18N("qingquerendenglumima"), "#loginRePwd", {
                tips: [3, "#0e9e80"], time: 2000, end: function () {
                    $("#btn_next").removeAttr("disabled");
                }
            })
            return false;
        }

        if (loginPwd != loginRePwd) {
            layer.tips(langPkg.getI18N("buyizhi"), "#loginRePwd", {
                tips: [3, "#0e9e80"], time: 2000, end: function () {
                    $("#btn_next").removeAttr("disabled");
                }
            })
            return false;
        }
        if (!$.passwordStrength(loginPwd)) {
            layer.tips(langPkg.getI18N("mimaqiangdutaidi"), "#loginRePwd", {
                tips: [3, "#0e9e80"], time: 2000, end: function () {
                    $("#btn_next").removeAttr("disabled");
                }
            });
            return false;
        }
        var param = {
            code: code,
            pwd: loginRePwd,
            username: username,

        };

        $.ajaxSendData(param, "/api/user/back/pwd/v2", function(resData){
            layer.msg(langPkg.getI18N("denglumimaxiugaichenggong"), { time: 1500, icon: 1 }, function () {
                $("#find_step1").hide();
                $("#find_step2").show();
                toLoginPage();
            })
        }, function(resData){
            layer.msg(resData.msg, { time: 2000, icon: 5 }, function () {
                $("#btn_next").removeAttr("disabled");
            })
        });
    }
    //  获取验证码，只是为了弹出框
    function getCode(_this) {
        var username = $("#phone").val();
        if(username == ""){
            layer.tips(langPkg.getI18N("qingshuruyonghuming"), "#phone", {
                tips: [3, "#0e9e80"], time: 2000
            });
            return false;
        }
        var param = {
            username: username
        }
        $.ajaxSendData(param, "/api/user/verify/username", function(resData){
            if(resData.data){
                //打开阿里验证
                OpenAliValidate(_this, username, 3, $('#btn_sendCode'));
                $("#btn_next").removeClass("notAliValidata").removeAttr("disabled");
            }else{
                layer.msg(langPkg.getI18N("zhanghaoweizhuce"), { time: 2000, icon: 5 }, function () {
                    $("#btn_next").addClass("notAliValidata").attr("disabled", "disabled");
                })
            }
        }, function(resData){
            layer.msg(resData.msg, { time: 2000, icon: 5 }, function () {
                $("#btn_next").removeAttr("disabled");
            })
        });
    }

    /**
     *  跳转到登录页面
     */
    function toLoginPage() {
        var obj = $('#wait');
        var wait = 3;
        var interval = setInterval(function () {
            obj.html(wait);
            wait--;
            if (wait < 0) {
                clearInterval(interval);
                $.loginOut();
                var href = window.location.href;
                //  判断项目所在目录
                var loginUrl = href.substr(0,href.lastIndexOf("/")+1) +  "login.html";
                window.location.href = loginUrl;
            }
        }, 1000);
    }
</script>

</body>
</html>
